# PSP 0009 â€” Shit Async Programming

## Abstract

This document defines the **worst possible way** to use Python `async` and `await`.
If normal async code tries to be readable, PSP 9 exists to **confuse everyone and make the event loop cry**.

---

## Principles

1. **Unnecessary `async` everywhere**
   Every function, even trivial ones, must be async.

   ```python
   async def add(a, b):
       return a + b
   ```

2. **Random `await` abuse**
   Await meaningless expressions, constants, or sleeps for chaos.

   ```python
   import asyncio
   async def chaos():
       await asyncio.sleep(0)
       await 42
   ```

3. **Loop your loop**
   Nest async loops as deep as possible, even if unnecessary.

   ```python
   async def nested():
       for i in range(10):
           for j in range(10):
               await asyncio.sleep(0)
   ```

4. **Callback nightmares**
   Call async functions from sync code incorrectly (but still let it "work" with `asyncio.run`).

   ```python
   def sync_wrapper():
       asyncio.run(chaos())
   ```

5. **Event loop chaos**
   Start multiple loops, or never close them. Make `RuntimeError: Event loop is closed` happen often.

   ```python
   loop1 = asyncio.new_event_loop()
   loop2 = asyncio.new_event_loop()
   loop1.run_until_complete(chaos())
   loop2.run_until_complete(chaos())
   ```

---

## Example

```python
import asyncio
import random

async def WHY_AM_I_ALIVE():
    await asyncio.sleep(random.random())
    print("chaos awaits")

async def main():
    await WHY_AM_I_ALIVE()
    await WHY_AM_I_ALIVE()
    await asyncio.sleep(0)

asyncio.run(main())
```

---

## Conclusion

Shit async programming guarantees:

* race conditions everywhere,
* event loops panic,
* linters cry silently.